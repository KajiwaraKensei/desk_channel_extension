!function(){var n,t={131:function(n,t,e){"use strict";var r=e(416),o=function(n,t,e,r){return new(e||(e=Promise))((function(o,i){function c(n){try{s(r.next(n))}catch(n){i(n)}}function u(n){try{s(r.throw(n))}catch(n){i(n)}}function s(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}s((r=r.apply(n,t||[])).next())}))};const i=".hxficf",c=1e3;function u(n=0){return o(this,void 0,void 0,(function*(){var t;if(!document.querySelector(i))return yield(t=c,new Promise((n=>setTimeout(n,t)))),u(n+1)}))}function s(){const n=a(document.querySelector(i));if(n.indexOf("wrap")<0)return void setTimeout(s,c);const t=document.createElement("style");t.innerText=`\n  .${n} > div > div:nth-child(2) img{ \n    display: none;\n  }\n  `,document.getElementsByTagName("HEAD").item(0).appendChild(t)}function a(n){return n||setTimeout(s,c),n.childElementCount>2?n.className:a(n.children.item(0))}var f=e(869),l=e.n(f),h=e(162);const d={type:"binary"};function p(){return n=this,t=void 0,r=function*(){const n=function(n){const t=[];n.messages.forEach((({personType:n,createdAt:e,plainText:r})=>{t.push([n,new Date(e).toLocaleString(),r])}));const e=function(n,t){return function(n,t){const e="Sheet1";let r={};return r[e]=n,{SheetNames:[e],Sheets:r}}(l().utils.aoa_to_sheet(n,t))}(t);return l().write(e,d)}(yield function(){return n=this,t=void 0,r=function*(){const n=document.URL.split("/");let t="",e="";n.forEach(((r,o)=>{"channels"===r&&(t=n[o+1]),"user_chats"===r&&(e=n[o+1])}));const r=`https://desk-api.channel.io/desk/channels/${t}/user-chats/${e}/messages?sortOrder=asc&limit=10000`;return yield fetch(r,{credentials:"include"}).then((n=>n.json()))},new((e=void 0)||(e=Promise))((function(o,i){function c(n){try{s(r.next(n))}catch(n){i(n)}}function u(n){try{s(r.throw(n))}catch(n){i(n)}}function s(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}s((r=r.apply(n,t||[])).next())}));var n,t,e,r}()),t=new Blob([v(n)],{type:"application/octet-stream"});(0,h.saveAs)(t,"myExcelFile.xlsx")},new((e=void 0)||(e=Promise))((function(o,i){function c(n){try{s(r.next(n))}catch(n){i(n)}}function u(n){try{s(r.throw(n))}catch(n){i(n)}}function s(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}s((r=r.apply(n,t||[])).next())}));var n,t,e,r}function v(n){const t=new ArrayBuffer(n.length);let e=new Uint8Array(t);for(let t=0;t!=n.length;++t)e[t]=255&n.charCodeAt(t);return t}r.browser.runtime.onMessage.addListener((n=>{const t={copyAll:()=>{p().then((n=>{r.browser.runtime.sendMessage({type:"copy_txt_p",txt:n})})).catch((n=>{r.browser.runtime.sendMessage({type:"copy_txt_p_e",error:n})}))}};t[n.type]&&t[n.type](n)})),function(){o(this,void 0,void 0,(function*(){yield u(),s()}))}()},382:function(){},95:function(){},219:function(){}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n].call(i.exports,i,i.exports,r),i.exports}r.m=t,n=[],r.O=function(t,e,o,i){if(!e){var c=1/0;for(f=0;f<n.length;f++){e=n[f][0],o=n[f][1],i=n[f][2];for(var u=!0,s=0;s<e.length;s++)(!1&i||c>=i)&&Object.keys(r.O).every((function(n){return r.O[n](e[s])}))?e.splice(s--,1):(u=!1,i<c&&(c=i));if(u){n.splice(f--,1);var a=o();void 0!==a&&(t=a)}}return t}i=i||0;for(var f=n.length;f>0&&n[f-1][2]>i;f--)n[f]=n[f-1];n[f]=[e,o,i]},r.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return r.d(t,{a:t}),t},r.d=function(n,t){for(var e in t)r.o(t,e)&&!r.o(n,e)&&Object.defineProperty(n,e,{enumerable:!0,get:t[e]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(n){if("object"==typeof window)return window}}(),r.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},function(){var n={998:0};r.O.j=function(t){return 0===n[t]};var t=function(t,e){var o,i,c=e[0],u=e[1],s=e[2],a=0;if(c.some((function(t){return 0!==n[t]}))){for(o in u)r.o(u,o)&&(r.m[o]=u[o]);if(s)var f=s(r)}for(t&&t(e);a<c.length;a++)i=c[a],r.o(n,i)&&n[i]&&n[i][0](),n[c[a]]=0;return r.O(f)},e=self.webpackChunk=self.webpackChunk||[];e.forEach(t.bind(null,0)),e.push=t.bind(null,e.push.bind(e))}();var o=r.O(void 0,[416,939],(function(){return r(131)}));o=r.O(o)}();